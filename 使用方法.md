# 🎓 兵庫県立大学シラバスPDF変換ツール 使用方法

## 📋 必要な準備

### 1. ウイルス対策ソフトの設定

**重要**: このツールはPyInstallerで作成された実行ファイルのため、**ウイルス対策ソフトに誤検出される可能性があります**。

#### 検出された場合の対処方法

1. **隔離されたファイルを復元**
   - ウイルス対策ソフトの履歴・隔離リストを確認
   - `SyllabusPDF.exe` を復元

2. **除外設定を追加**
   - ウイルス対策ソフトの設定を開く
   - 「除外」「ホワイトリスト」「例外」等の項目を探す
   - `SyllabusPDF.exe` のフルパスを除外リストに追加

3. **主要ウイルス対策ソフト別の設定例**
   - **Windows Defender**: 設定 → ウイルスと脅威の防止 → 除外 → ファイルまたはフォルダーを追加
   - **ウイルスバスター**: メイン画面 → 設定 → 例外設定 → 検索対象の除外
   - **ノートン**: 設定 → ウイルス対策 → スキャンとリスク → 除外/低リスク
   - **マカフィー**: 設定 → リアルタイムスキャン → 除外ファイル

4. **一時的な対処**
   - リアルタイム保護を一時的に無効化してツールを実行
   - 実行後は必ず保護を再有効化

#### なぜ誤検出されるのか

- PyInstallerで作成された実行ファイルは、Pythonスクリプトと必要なライブラリを1つのファイルにパッケージ化します
- この圧縮・パッケージ化技術がマルウェアでも使用されるため、ウイルス対策ソフトが誤検出することがあります
- **このツールは完全に安全です** - ソースコードは公開されており、悪意のある動作は一切行いません

### 2. wkhtmltopdf のインストール

このツールはPDF変換に `wkhtmltopdf` を使用します。以下の手順でインストールしてください：

1. **ダウンロード**
   - https://wkhtmltopdf.org/downloads.html にアクセス
   - Windows版をダウンロード（推奨：64-bit installer）

2. **インストール**
   - ダウンロードしたファイルを実行
   - デフォルト設定でインストール（推奨パス: `C:\Program Files\wkhtmltopdf\`）

3. **確認**
   - ツール起動時に「✅ wkhtmltopdf 検出済み - PDF変換可能」と表示されればOK
   - 「❌ wkhtmltopdf が見つかりません」と表示される場合は再インストール

## 🚀 ツールの使用方法

### 1. 授業コードリストファイルの準備

テキストファイル（.txt）を作成し、1行に1つの授業コードを記入：

```txt
ABC123
DEF456
GHI789
JKL012
```

**重要**:
- 授業コードのみ記入（URLではない）
- 1行1コード
- 空行があっても問題なし

### 2. ツールの操作手順

1. **SyllabusPDF.exe を起動**

2. **年度を設定**
   - 「年度」欄に対象年度を入力（例：2025）
   - 2020年以降の任意の年度が設定可能

3. **授業コードリストファイルを選択**
   - 「参照」ボタンをクリック
   - 準備したテキストファイルを選択

4. **PDF保存先を選択**
   - 「参照」ボタンをクリック
   - PDFファイルを保存するフォルダを選択

5. **変換開始**
   - 「シラバスPDF変換開始」ボタンをクリック
   - 進捗がリアルタイムで表示されます

### 3. 変換結果

- 各授業コードに対応するPDFファイルが作成されます
- ファイル名：`授業コード.pdf`（例：`ABC123.pdf`）
- 既に同名ファイルが存在する場合はスキップされます

## 🔗 対応するシラバスURL形式

このツールは以下の兵庫県立大学シラバスURL形式に対応しています：

```
https://syllabus.u-hyogo.ac.jp/slResult/[年度]/japanese/syllabusHtml/SyllabusHtml.[年度].[授業コード].html
```

例：
- 年度：2025
- 授業コード：ABC123
- 生成URL：`https://syllabus.u-hyogo.ac.jp/slResult/2025/japanese/syllabusHtml/SyllabusHtml.2025.ABC123.html`

## 📊 進捗とログの見方

### 進捗表示
- 現在処理中の授業コードと進捗（例：`[3/10] ABC123 変換中...`）
- プログレスバーで全体の進捗を表示

### ログ表示
```
[14:25:30] シラバスPDF変換開始: 5件の授業コード
[14:25:30] 対象年度: 2025年度
[14:25:30] 出力先: C:\Users\...\PDFs
======================================================================
[14:25:31] [1/5] 変換中: ABC123
[14:25:31]     URL: https://syllabus.u-hyogo.ac.jp/...
[14:25:35]     ✓ 成功: ABC123.pdf (245.3 KB)
[14:25:36] [2/5] スキップ（既存）: DEF456
[14:25:37] [3/5] 変換中: GHI789
[14:25:37]     ✗ 失敗: PDF作成エラー（シラバスが存在しない可能性）
======================================================================
[14:26:15] シラバスPDF変換完了: 4/5 件のPDFを作成
```

## ⚠️ トラブルシューティング

### wkhtmltopdf が見つからない場合
- ツール上部に「❌ wkhtmltopdf が見つかりません」と表示
- 解決方法：wkhtmltopdf を再インストール
- インストール後、ツールを再起動

### PDF変換に失敗する場合
- 「✗ 失敗: PDF作成エラー」と表示
- 原因：該当する授業コードのシラバスが存在しない
- 対処：授業コードが正しいか確認

### ツールが起動しない場合
- **ウイルス対策ソフトに隔離されている**（最も可能性が高い原因）
- 上記「ウイルス対策ソフトの設定」で除外設定を追加
- Windows 10/11 64bit環境で実行
- 管理者権限で実行を試行

### ウイルス対策ソフトに検出される場合
- 上記「ウイルス対策ソフトの設定」セクションを参照
- ファイルを除外リストに追加
- 一時的にリアルタイム保護を無効化して実行

### ファイルが保存されない場合
- 保存先フォルダの書き込み権限を確認
- 十分な空き容量があるか確認

## 💡 使用のコツ

- **大量変換時**: 一度に数百件処理することも可能ですが、時間がかかります
- **既存ファイル**: 同名PDFがある場合は自動スキップされるため、中断・再開が安全
- **年度確認**: 授業コードと年度の組み合わせが正しいか事前確認
- **進捗確認**: ログで成功/失敗の詳細を確認可能

## 📞 サポート

このツールは兵庫県立大学のシラバスシステム専用です。他の大学のシラバスには対応していません。